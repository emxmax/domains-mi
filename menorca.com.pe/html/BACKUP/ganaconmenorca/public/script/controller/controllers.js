// Generated by CoffeeScript 1.10.0
app.controller('procesoCrl', [
  '$scope', '$location', function(scope, location) {
    scope.irSeccion = function() {
      window.location.href = "formulario.html";
    };
  }
]);

app.controller('formularioCrl', [
  '$scope', '$location', '$http', '$timeout', function(scope, location, http, timeout) {
    scope.propietario = [];
    scope.propietario = {};
    scope.error = "campos Obligatorios";
    scope.validacion = function() {
      $("#form").validate({
        rules: {
          nombre: "required",
          nombre_1: "required",
          nombre_2: "required",
          nombre_3: "required",
          nombre_4: "required",
          nombre_5: "required",
          telefono: {
            required: true,
            number: true
          },
          telefono_1: {
            required: true,
            number: true
          },
          telefono_2: {
            required: true,
            number: true
          },
          telefono_3: {
            required: true,
            number: true
          },
          telefono_4: {
            required: true,
            number: true
          },
          telefono_5: {
            required: true,
            number: true
          },
          dni: {
            required: true,
            number: true
          }
        },
        errorLabelContainer: $("#form .form-error")
      });
    };
    scope.ocultarmensaje = function() {
      $(".form-error").fadeOut("slow");
    };
    scope.guardarform = function(data) {
      var result, url;
      console.log(scope.propietario);
      if ($("#form").valid()) {
        url = './controllers/propietario/saveform.php';
        result = http.post(url, {
          data: data
        });
        $(".botonera").fadeOut("slow");
        result.success(function(response) {
          console.log(response);
          $(".botonera").fadeIn("slow");
          $("#form")[0].reset();
          timeout(scope.ocultarmensaje, 5000);
        });
        result.error(function(error) {
          console.log(error);
        });
      } else {
        console.log(" no");
      }
    };
    scope.validacion();
  }
]);
