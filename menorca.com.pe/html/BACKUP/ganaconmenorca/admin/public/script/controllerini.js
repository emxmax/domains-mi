// Generated by CoffeeScript 1.10.0
'use strict';
var app;

app = angular.module("MenorcaLotes", ['ngRoute', 'ngCookies', 'angularUtils.directives.dirPagination', 'ngSanitize', 'com.2fdevs.videogular', 'com.2fdevs.videogular.plugins.controls', 'com.2fdevs.videogular.plugins.overlayplay', 'com.2fdevs.videogular.plugins.poster', 'btford.modal']);

app.config([
  '$routeProvider', function(routeProvier) {
    var routeP;
    routeP = routeProvier;
    routeP.when('/', {
      templateUrl: 'public/views/login/login.html',
      controller: 'LoginCrl'
    });
    routeP.when('/login', {
      templateUrl: 'public/views/login/login.html',
      controller: 'LoginCrl'
    });
    routeP.when('/vista/principal', {
      templateUrl: 'public/views/propietario/lista.html',
      controller: ''
    });
    routeP.when('/vista/propietario', {
      templateUrl: 'public/views/propietario/lista.html',
      controller: ''
    });
    routeP.when('/vista/usuarios', {
      templateUrl: 'public/views/user/lista.html',
      controller: ''
    });
    routeP.otherwise({
      redirecTo: '/login'
    });
  }
]);

app.run([
  '$rootScope', '$location', '$cookieStore', '$http', function(rootScope, location, cookieStore, http) {
    rootScope.globals = cookieStore.get('globals') || {};
    if (rootScope.globals.currentUser) {
      http.defaults.headers.common['Authorization'] = 'Basic ' + rootScope.globals.currentUser.authdata;
    }
    rootScope.$on('$locationChangeStart', function(event, next, current) {
      if (location.path() !== '/login' && !rootScope.globals.currentUser) {
        location.path('/login');
      }
    });
  }
]);
